import os, glob

configfile: "../config/config.json"

include: "rules/common.smk"
include: "rules/downloads.smk"
include: "rules/sno_literature_processing.smk"
include: "rules/sno_tgirt_seq_processing.smk"
include: "rules/sno_families.smk"
include: "rules/negative_examples.smk"
include: "rules/negative_examples_fixed_length_520nt.smk"
include: "rules/tune_train_test_sets.smk"
include: "rules/one_hot_encoding_and_normalization.smk"


rule all:
    input:
        shuffled_sno_df = 'data/references/negatives/shuffle_sno/random_shuffle_all_expressed_cd_fixed_length_520nt.tsv',
        df = 'data/references/rnacentral/filtered_tRNA_snRNA_pre_miRNA_fixed_length_520nt.tsv',
        df_haca = expand('data/references/HACA/{species}_HACA_location_formated_fixed_length_520nt.tsv', species=[sp for sp in config['species'] + config['species_tgirt'] 
                            if sp not in ['ostreococcus_tauri', 'schizosaccharomyces_pombe', 'tetrahymena_thermophila']]),
        test_df = 'data/references/positives_and_negatives/initial/initial_test_set.tsv',
        test = 'data/references/negatives/initial/negatives_test_set_fixed_length_520nt.tsv'
        #normalized_test = 'data/references/positives_and_negatives/initial/initial_encoded_scaled_test_set.tsv'

rule all_downloads:
    input:
        blat_installation_file = "data/references/blat/blat_test.txt",
        genome = expand('data/references/genome_fa/{species}_genome.fa', **config),
        bed = expand('data/references/rnacentral/{species}.bed', 
                species=[sp for sp in config['species']+config['species_tgirt'] 
                        if sp not in ['ostreococcus_tauri', 'schizosaccharomyces_pombe']]),
        gallus_gallus_gff = "data/references/rnacentral/gallus_gallus_bGalGal1_GRCg7b.gff3",
        gtf = expand('data/references/gtf/{species}.gtf', species=[sp for sp in 
                        config['species']+config['species_tgirt'] if sp not in 
                        ['ostreococcus_tauri', 'schizosaccharomyces_pombe']]),
        rfam_clans = "data/references/rfam/fam_clans_families.tsv"




